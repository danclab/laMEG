

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>lameg package &#8212; laMEG 0.1.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_source/lameg';</script>
    <link rel="canonical" href="https://danclab.github.io/laMEG/_source/lameg.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
    <p class="title logo__title">lameg</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_tutorials/index.html">
                        Tutorials gallery
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/danclab/laMEG">
                    GitHub
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/danclab/laMEG" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/danc_labo" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_tutorials/index.html">
                        Tutorials gallery
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/danclab/laMEG">
                    GitHub
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/danclab/laMEG" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/danc_labo" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">lameg package</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="lameg-package">
<h1>lameg package<a class="headerlink" href="#lameg-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="lameg-invert-module">
<h2>lameg.invert module<a class="headerlink" href="#lameg-invert-module" title="Permalink to this heading">#</a></h2>
</section>
<section id="lameg-laminar-module">
<h2>lameg.laminar module<a class="headerlink" href="#lameg-laminar-module" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-lameg.postinstall">
<span id="lameg-postinstall-module"></span><h2>lameg.postinstall module<a class="headerlink" href="#module-lameg.postinstall" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="lameg.postinstall.clone_and_install_spm">
<span class="sig-prename descclassname"><span class="pre">lameg.postinstall.</span></span><span class="sig-name descname"><span class="pre">clone_and_install_spm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lameg.postinstall.clone_and_install_spm" title="Permalink to this definition">#</a></dt>
<dd><p>Clones the SPM repository and installs it.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lameg.postinstall.run_postinstall">
<span class="sig-prename descclassname"><span class="pre">lameg.postinstall.</span></span><span class="sig-name descname"><span class="pre">run_postinstall</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lameg.postinstall.run_postinstall" title="Permalink to this definition">#</a></dt>
<dd><p>Run all laMEG post-installation setup tasks.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lameg.postinstall.setup_jupyter_extensions">
<span class="sig-prename descclassname"><span class="pre">lameg.postinstall.</span></span><span class="sig-name descname"><span class="pre">setup_jupyter_extensions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lameg.postinstall.setup_jupyter_extensions" title="Permalink to this definition">#</a></dt>
<dd><p>Sets up Jupyter notebook extensions.</p>
<p>This method creates a script to install and enable the Jupyter <cite>k3d</cite> extension for the
environment. The script will be executed when the environment is activated.</p>
</dd></dl>

</section>
<section id="lameg-simulate-module">
<h2>lameg.simulate module<a class="headerlink" href="#lameg-simulate-module" title="Permalink to this heading">#</a></h2>
</section>
<section id="lameg-surf-module">
<h2>lameg.surf module<a class="headerlink" href="#lameg-surf-module" title="Permalink to this heading">#</a></h2>
</section>
<section id="lameg-util-module">
<h2>lameg.util module<a class="headerlink" href="#lameg-util-module" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-lameg.viz">
<span id="lameg-viz-module"></span><h2>lameg.viz module<a class="headerlink" href="#module-lameg.viz" title="Permalink to this heading">#</a></h2>
<p>Visualization and color mapping utilities for laminar and cortical surface data.</p>
<p>This module provides a set of functions for visualizing laminar MEG and cortical data, including
color mapping utilities, 3D surface rendering, and Current Source Density (CSD) plotting. It
integrates seamlessly with FreeSurfer surfaces, laMEG outputs, and matplotlib-based plotting
pipelines.</p>
<section id="main-features">
<h3>Main Features<a class="headerlink" href="#main-features" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Color Mapping</strong>:
- Convert numerical data into RGB, RGBA, or hexadecimal color representations.
- Support for diverging, linear, and logarithmic normalization schemes.
- Utilities for encoding RGB triplets as 32-bit integers for compact graphical representation.</p></li>
<li><p><strong>Surface Visualization</strong>:
- Render 3D cortical surfaces using the <cite>k3d</cite> engine.
- Overlay vertex-wise statistical maps, curvature-based shading, and anatomical markers.
- Interactive camera controls and scene export support.</p></li>
<li><p><strong>Laminar Data Visualization</strong>:
- Visualization of Current Source Density (CSD) profiles across cortical layers.
- Optional display of laminar boundaries and custom color scaling.</p></li>
</ul>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">#</a></h3>
<dl class="simple">
<dt>data_to_rgb(data, n_bins, cmap, vmin, vmax, vcenter=0.0, ret_map=False, norm=’TS’)</dt><dd><p>Map numerical data to RGBA colors using matplotlib colormaps with specified normalization.</p>
</dd>
<dt>rgbtoint(rgb)</dt><dd><p>Convert an RGB color triplet to a 32-bit integer color code.</p>
</dd>
<dt>color_map(data, cmap, vmin, vmax, n_bins=1000, vcenter=0, norm=’TS’)</dt><dd><p>Map numerical data to hexadecimal color codes suitable for visualization.</p>
</dd>
<dt>show_surface(surf_set, layer_name=’inflated’, stage=’combined’, …)</dt><dd><p>Render a cortical or laminar surface with optional curvature, color, and marker overlays.</p>
</dd>
<dt>plot_csd(csd, times, axis, colorbar=True, cmap=’RdBu_r’, …)</dt><dd><p>Plot a 2D laminar Current Source Density (CSD) profile over time.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>All functions are designed to integrate with laMEG’s surface and layer representations.</p></li>
<li><p>Surface visualization relies on <cite>k3d</cite> for GPU-accelerated rendering.</p></li>
<li><p>The module assumes FreeSurfer-compatible surface files and curvature data.</p></li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="lameg.viz.color_map">
<span class="sig-prename descclassname"><span class="pre">lameg.viz.</span></span><span class="sig-name descname"><span class="pre">color_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lameg.viz.color_map" title="Permalink to this definition">#</a></dt>
<dd><p>Map numerical data to hexadecimal color codes using a specified matplotlib colormap.</p>
<p>This function normalizes numerical data using a chosen normalization scheme, maps values to
RGB colors via a matplotlib colormap, and converts them to hexadecimal format suitable for
visualization (e.g., in surface plots or colorbar annotations).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>,</em><em>)</em>) – One-dimensional array of numerical values to be color-mapped.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – Name of the matplotlib colormap (e.g., <cite>‘viridis’</cite>, <cite>‘RdBu_r’</cite>).</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – Minimum data value for normalization.</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – Maximum data value for normalization.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of histogram bins used to discretize the data range. Default is 1000.</p></li>
<li><p><strong>vcenter</strong> (<em>float</em><em>, </em><em>optional</em>) – Center value for diverging normalization (<cite>norm=’TS’</cite>). Default is 0.</p></li>
<li><p><strong>norm</strong> (<em>{'TS'</em><em>, </em><em>'N'</em><em>, </em><em>'LOG'}</em><em>, </em><em>optional</em>) – Type of normalization:
- <cite>‘TS’</cite>: Two-slope (diverging) normalization.
- <cite>‘N’</cite>: Linear normalization.
- <cite>‘LOG’</cite>: Logarithmic normalization.
Default is <cite>‘TS’</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>map_colors</strong> (<em>ndarray, shape (n,)</em>) – Array of hexadecimal color codes corresponding to the input data values.</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.colors.Colormap</em>) – The matplotlib colormap object used for mapping.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Internally uses <cite>data_to_rgb()</cite> to compute RGBA values, which are then scaled and converted
to hexadecimal color codes.</p></li>
<li><p>The <cite>‘TS’</cite> normalization is suited for data centered around a neutral reference (e.g., zero).</p></li>
<li><p>Useful for generating vertex-wise color encodings or colorbars consistent with matplotlib
colormaps.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lameg.viz.data_to_rgb">
<span class="sig-prename descclassname"><span class="pre">lameg.viz.</span></span><span class="sig-name descname"><span class="pre">data_to_rgb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lameg.viz.data_to_rgb" title="Permalink to this definition">#</a></dt>
<dd><p>Map numerical data values to RGB colors using a specified matplotlib colormap.</p>
<p>This function normalizes input data according to a chosen scaling mode (two-slope, linear,
or logarithmic), bins the data into a specified number of intervals, and maps each bin to
an RGB color value. It optionally returns the colormap object for use in associated plots
(e.g., colorbars).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>,</em><em>)</em>) – One-dimensional array of numerical values to be color-mapped.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em>) – Number of histogram bins used to discretize the data range.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – Name of the matplotlib colormap (e.g., <cite>‘viridis’</cite>, <cite>‘RdBu_r’</cite>).</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – Minimum data value for normalization.</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – Maximum data value for normalization.</p></li>
<li><p><strong>vcenter</strong> (<em>float</em><em>, </em><em>optional</em>) – Center value for the colormap when using two-slope normalization (<cite>norm=”TS”</cite>).
Default is 0.0.</p></li>
<li><p><strong>ret_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return the matplotlib <cite>ScalarMappable</cite> object along with the mapped RGB values.
Default is False.</p></li>
<li><p><strong>norm</strong> (<em>{'TS'</em><em>, </em><em>'N'</em><em>, </em><em>'LOG'}</em><em>, </em><em>optional</em>) – Normalization type:
- <cite>‘TS’</cite>: Two-slope normalization (diverging colormap, zero-centered)
- <cite>‘N’</cite>: Linear normalization
- <cite>‘LOG’</cite>: Logarithmic normalization
Default is <cite>‘TS’</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>color_mapped</strong> (<em>ndarray, shape (n, 4)</em>) – Array of RGBA color values corresponding to each input datum.</p></li>
<li><p><strong>scalar_map</strong> (<em>matplotlib.cm.ScalarMappable, optional</em>) – The colormap object used for mapping (returned only if <cite>ret_map=True</cite>).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <cite>norm</cite> is not one of <cite>‘TS’</cite>, <cite>‘N’</cite>, or <cite>‘LOG’</cite>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function assigns each data point the color of its corresponding histogram bin.</p></li>
<li><p>The <cite>‘TS’</cite> normalization is best suited for data centered around a neutral reference value
(e.g., 0), producing balanced diverging colormaps.</p></li>
<li><p>The returned colors can be directly used for visualizing scalar data distributions or
as vertex colors in surface plots.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lameg.viz.plot_csd">
<span class="sig-prename descclassname"><span class="pre">lameg.viz.</span></span><span class="sig-name descname"><span class="pre">plot_csd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin_vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_boundaries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lameg.viz.plot_csd" title="Permalink to this definition">#</a></dt>
<dd><p>Visualize a laminar Current Source Density (CSD) profile over time.</p>
<p>This function plots a 2D representation of CSD data (layers × time) using a diverging
colormap to indicate current sources and sinks. It supports automatic or user-defined color
scaling, customizable colormaps, and optional display of laminar boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csd</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_layers</em><em>, </em><em>n_times</em><em>)</em>) – CSD matrix to plot, where each row corresponds to a cortical layer and each column to a
time point.</p></li>
<li><p><strong>times</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_times</em><em>,</em><em>)</em>) – Time vector corresponding to the CSD data columns (in ms).</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axes.Axes</em>) – Matplotlib axes on which to draw the CSD plot.</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, adds a colorbar indicating CSD amplitude (source/sink polarity). Default is True.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap name (e.g., <cite>‘RdBu_r’</cite>, <cite>‘viridis’</cite>). Default is <cite>‘RdBu_r’</cite>.</p></li>
<li><p><strong>vmin_vmax</strong> (<em>tuple</em><em> of </em><em>float</em><em> or </em><em>{'norm'</em><em>, </em><em>None}</em><em>, </em><em>optional</em>) – Color normalization limits:
- (vmin, vmax): explicit color scale limits,
- <cite>‘norm’</cite>: symmetric normalization based on maximum absolute CSD value,
- None: uses full data range. Default is None.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of cortical layers represented in the CSD matrix. Default is 11.</p></li>
<li><p><strong>layer_boundaries</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Optional array of y-axis positions marking laminar boundaries. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>im</strong> (<em>matplotlib.image.AxesImage</em>) – The plotted image object.</p></li>
<li><p><strong>cb</strong> (<em>matplotlib.colorbar.Colorbar or None</em>) – The colorbar object, if <cite>colorbar=True</cite>, otherwise None.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Assumes CSD is in units of current per unit area (e.g., uA/mm²).</p></li>
<li><p>Negative values (blue) typically represent current sinks; positive values (red) represent
sources.</p></li>
<li><p>If <cite>layer_boundaries</cite> is provided, horizontal lines are drawn at those positions.</p></li>
<li><p>Suitable for visualizing laminar profiles from simulations, hpMEG reconstructions, or
LFP-derived CSD estimates.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lameg.viz.rgbtoint">
<span class="sig-prename descclassname"><span class="pre">lameg.viz.</span></span><span class="sig-name descname"><span class="pre">rgbtoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rgb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lameg.viz.rgbtoint" title="Permalink to this definition">#</a></dt>
<dd><p>Convert an RGB triplet to a 32-bit integer color representation.</p>
<p>This function encodes red, green, and blue components (0-255) into a single 32-bit integer,
enabling compact storage or low-level graphical interfacing. The resulting integer can be
decoded back into RGB components via bitwise operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rgb</strong> (<em>array_like</em><em> of </em><em>int</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – RGB color triplet with values in the range [0, 255].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>color</strong> – 32-bit integer encoding of the input RGB color.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If any RGB component is outside the valid range [0, 255].</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Values are packed in big-endian order: <cite>R &lt;&lt; 16 | G &lt;&lt; 8 | B</cite>.</p></li>
<li><p>Useful for transferring color information to graphics libraries that use integer encoding.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lameg.viz.show_surface">
<span class="sig-prename descclassname"><span class="pre">lameg.viz.</span></span><span class="sig-name descname"><span class="pre">show_surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surf_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inflated'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ds'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">menu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera_view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_vertices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_curvature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lameg.viz.show_surface" title="Permalink to this definition">#</a></dt>
<dd><p>Render a 3D cortical surface with optional curvature, vertex-wise data, and marker overlays.</p>
<p>This function visualizes a laminar or pial surface loaded from a <cite>LayerSurfaceSet</cite> object
using the <cite>k3d</cite> rendering backend. It supports curvature shading, vertex-specific color
mapping, and visualization of fiducial or region markers, providing a flexible interactive
3D view of laminar or anatomical surfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surf_set</strong> (<em>LayerSurfaceSet</em>) – Layer surface container providing access to laminar or pial surfaces.</p></li>
<li><p><strong>layer_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the layer to render (e.g., <cite>‘pial’</cite>, <cite>‘white’</cite>, <cite>‘inflated’</cite>). Default is
<cite>‘inflated’</cite>.</p></li>
<li><p><strong>stage</strong> (<em>{'combined'</em><em>, </em><em>'ds'}</em><em>, </em><em>optional</em>) – Rendering stage: <cite>‘combined’</cite> for merged hemispheres, <cite>‘ds’</cite> for downsampled single
surfaces. Default is <cite>‘combined’</cite>.</p></li>
<li><p><strong>hemi</strong> (<em>{'lh'</em><em>, </em><em>'rh'}</em><em>, </em><em>optional</em>) – Hemisphere to render. Required if <cite>stage=’ds’</cite>. Default is None.</p></li>
<li><p><strong>orientation</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Downsampling orientation identifier used when <cite>stage=’ds’</cite>. Ignored otherwise.</p></li>
<li><p><strong>fixed</strong> (<em>bool</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Whether to load fixed or adaptive orientation surfaces when <cite>stage=’ds’</cite>. Default is None.</p></li>
<li><p><strong>color</strong> (<em>array_like</em><em> of </em><em>int</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>optional</em>) – Base RGB color of the surface (0-255). Default is <cite>[166, 166, 166]</cite>.</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display background grid. Default is False.</p></li>
<li><p><strong>menu</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display interactive visualization menu. Default is False.</p></li>
<li><p><strong>vertex_colors</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Vertex-wise colors specified as either RGB(A) values or packed 32-bit integers. Default is
None.</p></li>
<li><p><strong>info</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints surface metadata (e.g., vertex count). Default is False.</p></li>
<li><p><strong>camera_view</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Predefined camera position and orientation. If None, automatic camera fitting is used.
Default is None.</p></li>
<li><p><strong>height</strong> (<em>int</em><em>, </em><em>optional</em>) – Plot height in pixels. Default is 512.</p></li>
<li><p><strong>opacity</strong> (<em>float</em><em>, </em><em>optional</em>) – Surface opacity (0 = transparent, 1 = opaque). Default is 1.0.</p></li>
<li><p><strong>marker_coords</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Marker coordinates (n × 3) in the same space as the surface vertices.</p></li>
<li><p><strong>marker_vertices</strong> (<em>array_like</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – Vertex indices to highlight as markers (used instead of explicit coordinates if provided).</p></li>
<li><p><strong>marker_size</strong> (<em>float</em><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Size (radius) of marker spheres. Default is 1.0.</p></li>
<li><p><strong>marker_color</strong> (<em>array_like</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>) or </em><em>(</em><em>n</em><em>, </em><em>3</em><em>)</em><em>, </em><em>optional</em>) – RGB color(s) of marker spheres (0-255). Default is <cite>[255, 0, 0]</cite>.</p></li>
<li><p><strong>plot_curvature</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, overlays sulcal curvature shading derived from FreeSurfer <cite>.curv</cite> files. Default
is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>plot</strong> – Interactive <cite>k3d</cite> plot object containing the rendered surface and optional overlays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>k3d.plot.Plot</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Supports both per-vertex color overlays (e.g., statistical maps) and curvature-based shading.</p></li>
<li><p>Vertex colors with an alpha channel (RGBA) use transparency to blend with curvature shading.</p></li>
<li><p>Curvature values are mapped to grayscale for sulcal and gyral regions.</p></li>
<li><p>If both <cite>marker_vertices</cite> and <cite>marker_coords</cite> are provided, the function prioritizes
<cite>marker_vertices</cite>.</p></li>
<li><p>Compatible with <cite>fsaverage</cite>-aligned surfaces and laminar surface sets generated by laMEG.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-lameg">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lameg" title="Permalink to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg-invert-module">lameg.invert module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg-laminar-module">lameg.laminar module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-lameg.postinstall">lameg.postinstall module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.postinstall.clone_and_install_spm"><code class="docutils literal notranslate"><span class="pre">clone_and_install_spm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.postinstall.run_postinstall"><code class="docutils literal notranslate"><span class="pre">run_postinstall()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.postinstall.setup_jupyter_extensions"><code class="docutils literal notranslate"><span class="pre">setup_jupyter_extensions()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg-simulate-module">lameg.simulate module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg-surf-module">lameg.surf module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg-util-module">lameg.util module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-lameg.viz">lameg.viz module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-features">Main Features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.viz.color_map"><code class="docutils literal notranslate"><span class="pre">color_map()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.viz.data_to_rgb"><code class="docutils literal notranslate"><span class="pre">data_to_rgb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.viz.plot_csd"><code class="docutils literal notranslate"><span class="pre">plot_csd()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.viz.rgbtoint"><code class="docutils literal notranslate"><span class="pre">rgbtoint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lameg.viz.show_surface"><code class="docutils literal notranslate"><span class="pre">show_surface()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-lameg">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/danclab/laMEG/edit/master/docs/_source/lameg.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/_source/lameg.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2024, DANC lab.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>